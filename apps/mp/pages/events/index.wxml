<view class="events-container">
  <!-- é¡¶éƒ¨æ ‡ç­¾ -->
  <view class="events-tabs">
    <view
      wx:for="{{tabs}}"
      wx:key="value"
      class="tab-item {{currentTab === item.value ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="{{item.value}}"
    >
      <text class="tab-text">{{item.label}}</text>
    </view>
  </view>

  <!-- æ´»åŠ¨åˆ—è¡¨ -->
  <view class="events-list">
    <scroll-view scroll-y refresher-enabled refresher-triggered="{{refreshing}}" bindrefresherrefresh="onRefresh">
      <view wx:for="{{events}}" wx:key="id" class="event-card" bindtap="viewEventDetail" data-id="{{item.id}}">
        <!-- æ´»åŠ¨å°é¢ -->
        <view class="event-cover">
          <image
            class="cover-image"
            src="{{item.coverImage || '/assets/event-default.jpg'}}"
            mode="aspectFill"
          />
          <view class="status-badge status-{{item.status}}">
            <text>{{item.statusText}}</text>
          </view>
          <view wx:if="{{item.type}}" class="type-badge">
            <text>{{item.type === 'TOURNAMENT' ? 'æ¯”èµ›' : ''}}</text>
            <text>{{item.type === 'PROMOTION' ? 'ä¿ƒé”€' : ''}}</text>
            <text>{{item.type === 'SPECIAL' ? 'ç‰¹æ®Š' : ''}}</text>
            <text>{{item.type === 'HOLIDAY' ? 'èŠ‚æ—¥' : ''}}</text>
          </view>
        </view>

        <!-- æ´»åŠ¨ä¿¡æ¯ -->
        <view class="event-content">
          <view class="event-header">
            <text class="event-name">{{item.name}}</text>
            <view class="event-time">
              <text class="time-text">{{item.timeText}}</text>
            </view>
          </view>

          <view class="event-description">
            <text>{{item.description}}</text>
          </view>

          <view class="event-details">
            <view class="detail-row">
              <text class="detail-icon">ğŸ“</text>
              <text class="detail-text">{{item.location || 'å¾·å·ä¸»é¢˜é…’å§'}}</text>
            </view>

            <view class="detail-row" wx:if="{{item.maxParticipants > 0}}">
              <text class="detail-icon">ğŸ‘¥</text>
              <text class="detail-text">{{item.currentParticipants}}/{{item.maxParticipants}}äºº</text>
              <view class="participants-progress">
                <view class="progress-bar">
                  <view
                    class="progress-fill"
                    style="width: {{(item.currentParticipants / item.maxParticipants * 100).toFixed(0)}}%"
                  ></view>
                </view>
              </view>
            </view>

            <view class="detail-row" wx:if="{{item.entryFee > 0}}">
              <text class="detail-icon">ğŸ’°</text>
              <text class="detail-text">æŠ¥åè´¹ï¼š{{item.entryFee}}ç§¯åˆ†</text>
            </view>

            <view class="detail-row" wx:if="{{item.rewardPoints > 0}}">
              <text class="detail-icon">ğŸ†</text>
              <text class="detail-text">å¥–åŠ±ï¼š{{item.rewardPoints}}ç§¯åˆ†</text>
            </view>

            <view class="detail-row" wx:if="{{item.minMemberLevel > 1}}">
              <text class="detail-icon">â­</text>
              <text class="detail-text">éœ€è¦V{{item.minMemberLevel}}åŠä»¥ä¸Šä¼šå‘˜</text>
            </view>
          </view>

          <!-- æŠ¥åçŠ¶æ€å’ŒæŒ‰é’® -->
          <view class="event-actions">
            <button
              class="btn-register btn-{{item.registrationStatus.type}}"
              wx:if="{{item.requiresRegistration}}"
              bindtap="registerEvent"
              data-id="{{item.id}}"
              disabled="{{item.registrationStatus.type === 'disabled' || item.registrationStatus.type === 'registered'}}"
              catchtap="registerEvent"
            >
              {{item.registrationStatus.text}}
            </button>

            <view wx:else class="no-registration">
              <text>æ— éœ€æŠ¥å</text>
            </view>
          </view>
        </view>
      </view>

      <!-- ç©ºçŠ¶æ€ -->
      <view wx:if="{{events.length === 0 && !loading}}" class="empty-state">
        <text class="empty-icon">ğŸª</text>
        <text class="empty-text">æš‚æ— {{tabs.find(t => t.value === currentTab).label}}æ´»åŠ¨</text>
      </view>

      <!-- åŠ è½½çŠ¶æ€ -->
      <view wx:if="{{loading}}" class="loading">
        <text>åŠ è½½ä¸­...</text>
      </view>
    </scroll-view>
  </view>
</view>