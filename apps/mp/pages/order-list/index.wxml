<view class="container">
  <!-- æ ‡ç­¾é¡µåˆ‡æ¢ -->
  <view class="tabs">
    <view
      wx:for="{{tabs}}"
      wx:key="status"
      class="tab-item {{currentTab === item.status ? 'active' : ''}}"
      bindtap="switchTab"
      data-status="{{item.status}}"
    >
      <text class="tab-text">{{item.label}}</text>
      <view wx:if="{{currentTab === item.status}}" class="tab-indicator"></view>
    </view>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view class="list-container">
    <view wx:if="{{loading}}" class="loading-box">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>

    <view wx:elif="{{orders.length === 0}}" class="empty-box">
      <text class="empty-icon">ğŸ“‹</text>
      <text class="empty-text">æš‚æ— è®¢å•è®°å½•</text>
      <button class="btn-goto-menu" bindtap="gotoMenu">å»ç‚¹é¤</button>
    </view>

    <view wx:else class="order-list">
      <view
        wx:for="{{orders}}"
        wx:key="id"
        class="order-item"
        bindtap="viewDetail"
        data-id="{{item.id}}"
      >
        <!-- è®¢å•å¤´éƒ¨ -->
        <view class="order-header">
          <view class="order-info">
            <text class="order-number">è®¢å•å·: {{item.orderNumber}}</text>
            <text class="order-time">{{item.createdAtText}}</text>
          </view>
          <view class="status-badge status-{{item.status}}">
            {{item.statusText}}
          </view>
        </view>

        <!-- é¤å…ä¿¡æ¯ -->
        <view wx:if="{{item.table}}" class="location-info">
          <text class="location-icon">ğŸ“</text>
          <text class="location-text">{{item.table.name}}</text>
          <text wx:if="{{item.reservation}}" class="reservation-tag">é¢„çº¦</text>
        </view>

        <!-- å•†å“åˆ—è¡¨ -->
        <view class="items-container">
          <view
            wx:for="{{item.items}}"
            wx:for-item="product"
            wx:key="id"
            class="item-row"
          >
            <view class="item-info">
              <text class="item-name">{{product.menuItem.name}}</text>
              <text class="item-desc">{{product.menuItem.description}}</text>
            </view>
            <view class="item-quantity">Ã—{{product.quantity}}</view>
            <view class="item-price">Â¥{{product.amount}}</view>
          </view>
        </view>

        <!-- è®¢å•æ€»è®¡ -->
        <view class="order-total">
          <view class="total-info">
            <text class="total-label">å…±{{item.totalQuantity}}ä»¶å•†å“</text>
            <text class="total-amount">åˆè®¡: Â¥{{item.totalAmount}}</text>
          </view>
        </view>

        <!-- æ“ä½œæŒ‰é’® -->
        <view class="action-buttons" wx:if="{{item.status === 'PENDING'}}">
          <button
            class="btn-cancel"
            catchtap="cancelOrder"
            data-id="{{item.id}}"
          >
            å–æ¶ˆè®¢å•
          </button>
          <button
            class="btn-pay"
            catchtap="payOrder"
            data-id="{{item.id}}"
          >
            ç«‹å³æ”¯ä»˜
          </button>
        </view>

        <view class="action-buttons" wx:elif="{{item.status === 'PAID' || item.status === 'IN_PROGRESS'}}">
          <button
            class="btn-contact"
            catchtap="contactService"
            data-id="{{item.id}}"
          >
            è”ç³»å®¢æœ
          </button>
        </view>

        <view class="action-buttons" wx:elif="{{item.status === 'COMPLETED'}}">
          <button
            class="btn-reorder"
            catchtap="reorder"
            data-id="{{item.id}}"
          >
            å†æ¥ä¸€å•
          </button>
        </view>
      </view>
    </view>
  </view>
</view>