<view class="ranking-container">
  <!-- é¡¶éƒ¨æ ‡ç­¾ -->
  <view class="ranking-tabs">
    <view
      wx:for="{{tabs}}"
      wx:key="value"
      class="tab-item {{currentTab === item.value ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="{{item.value}}"
    >
      <text class="tab-text">{{item.label}}</text>
    </view>
  </view>

  <!-- å‰ä¸‰åæ¦œå• -->
  <view class="top-three">
    <!-- ç¬¬äºŒå -->
    <view class="rank-item rank-2" wx:if="{{rankings.length > 1}}">
      <view class="rank-badge silver">2</view>
      <image class="avatar" src="{{rankings[1].avatar || '/assets/default-avatar.png'}}" mode="aspectFill" />
      <text class="nickname">{{rankings[1].nickname}}</text>
      <text class="points">{{rankings[1].points}}åˆ†</text>
    </view>

    <!-- ç¬¬ä¸€å -->
    <view class="rank-item rank-1" wx:if="{{rankings.length > 0}}">
      <view class="crown">ğŸ‘‘</view>
      <view class="rank-badge gold">1</view>
      <image class="avatar large" src="{{rankings[0].avatar || '/assets/default-avatar.png'}}" mode="aspectFill" />
      <text class="nickname">{{rankings[0].nickname}}</text>
      <text class="points">{{rankings[0].points}}åˆ†</text>
    </view>

    <!-- ç¬¬ä¸‰å -->
    <view class="rank-item rank-3" wx:if="{{rankings.length > 2}}">
      <view class="rank-badge bronze">3</view>
      <image class="avatar" src="{{rankings[2].avatar || '/assets/default-avatar.png'}}" mode="aspectFill" />
      <text class="nickname">{{rankings[2].nickname}}</text>
      <text class="points">{{rankings[2].points}}åˆ†</text>
    </view>
  </view>

  <!-- å…¶ä»–æ’ååˆ—è¡¨ -->
  <view class="ranking-list">
    <scroll-view scroll-y refresher-enabled refresher-triggered="{{refreshing}}" bindrefresherrefresh="onRefresh">
      <view wx:for="{{rankings}}" wx:key="id" wx:if="{{index >= 3}}" class="list-item {{item.isCurrentUser ? 'current-user' : ''}}">
        <view class="rank-number">{{index + 1}}</view>
        <image class="user-avatar" src="{{item.avatar || '/assets/default-avatar.png'}}" mode="aspectFill" />
        <view class="user-info">
          <text class="user-nickname">{{item.nickname}}</text>
          <text class="user-level">{{item.levelName || 'V1 æ™®é€šä¼šå‘˜'}}</text>
        </view>
        <view class="user-points">
          <text class="points-value">{{item.points}}</text>
          <text class="points-label">ç§¯åˆ†</text>
        </view>
      </view>

      <!-- å½“å‰ç”¨æˆ·æ’å -->
      <view wx:if="{{currentUserRank && currentUserRank.rank > 3}}" class="my-rank-card">
        <view class="my-rank-header">
          <text class="my-rank-title">æˆ‘çš„æ’å</text>
        </view>
        <view class="list-item current-user">
          <view class="rank-number">{{currentUserRank.rank}}</view>
          <image class="user-avatar" src="{{currentUserRank.avatar || '/assets/default-avatar.png'}}" mode="aspectFill" />
          <view class="user-info">
            <text class="user-nickname">{{currentUserRank.nickname}}</text>
            <text class="user-level">{{currentUserRank.levelName || 'V1 æ™®é€šä¼šå‘˜'}}</text>
          </view>
          <view class="user-points">
            <text class="points-value">{{currentUserRank.points}}</text>
            <text class="points-label">ç§¯åˆ†</text>
          </view>
        </view>
      </view>

      <view wx:if="{{rankings.length === 0 && !loading}}" class="empty-state">
        <text class="empty-icon">ğŸ†</text>
        <text class="empty-text">æš‚æ— æ’è¡Œæ•°æ®</text>
      </view>

      <view wx:if="{{loading}}" class="loading">
        <text>åŠ è½½ä¸­...</text>
      </view>
    </scroll-view>
  </view>
</view>